"0","impc_all<- read.csv(""Gene_lists/IMPC/ALL_genotype_phenotype.csv"",header=TRUE, sep = "","",fill=TRUE,stringsAsFactors = FALSE)"
"0","impc_all<-impc_all[-which(impc_all$mp_term_id==""""|impc_all$zygosity!=""homozygote""),]"
"0","lethalphens <- read.xlsx(""Gene_lists/MGI_MPs/MGI_lethal_phenotypes.xlsx"")"
"0","impc_all$is_lethal <- ifelse(impc_all$mp_term_id%in%lethalphens$MP.id,""Y"",""N"")"
"0","impc <- data.frame(mgi_id=unique(impc_all$marker_accession_id))"
"0","#mp ids"
"0","impc$all_MP_ID <- lapply(impc$mgi_id, function(x) unique(impc_all$mp_term_id[which(impc_all$marker_accession_id==x)]))"
"0","impc$all_MP_phen <- lapply(impc$mgi_id, function(x) unique(impc_all$mp_term_name[which(impc_all$marker_accession_id==x)]))"
"0","impc$lethal_MP_ID <- lapply(impc$mgi_id, function(x) unique(impc_all$mp_term_id[which(impc_all$marker_accession_id==x&impc_all$is_lethal==""Y"")]))"
"0","impc$lethal_MP_phen <- lapply(impc$mgi_id, function(x) unique(impc_all$mp_term_name[which(impc_all$marker_accession_id==x&impc_all$is_lethal==""Y"")]))"
"0","impc$is_lethal <- rep(""N"",length(impc$mgi_id))"
"0","impc$is_lethal[which(lengths(impc$lethal_MP_ID)>0)]<-""Y"""
"0","# add on gene names and human ortholog names"
"0","names <- read.csv(""Gene_lists/Universe/gene_with_protein_product.txt"",sep = ""\t"", comment.char = ""#"",stringsAsFactors = FALSE)"
"0","impc$human_symbol <- vlookup(impc$mgi_id,names,result_column=""symbol"",lookup_column = ""mgd_id"")"
"0","impc$human_symbol <- checkGeneSymbols(impc$human_symbol,unmapped.as.na=FALSE)[[3]]"
"0","#removing pseudogenes/non-coding genes etc"
"0","impc <- impc[-which(is.na(impc$human_symbol)),]"
"0","save(impc, file=""output/Data/impc.rda"", compress=""bzip2"")"
